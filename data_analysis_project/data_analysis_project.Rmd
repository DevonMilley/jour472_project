---
title: "Data Analysis Project"
author: "Devon Milley, Timothy Dashiell, Emmett Gartner"
date: "04/15/2022"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

In this notebook, we are analyzing this data, The Lasting Legacy Of Redlining.

## Variable explanations
HOLC Grades
One of the principal variables in this dataset is the Home Owners’ Loan Corporation (HOLC) grade. HOLC was a New Deal-era federal agency that collaborated with local banks, cities, and real estate appraisers to rate the “quality” of neighborhoods on a scale of A-D, with ‘A’ being the best and ‘D’ the worst. The variables used to determine these grades included objective indicators like access to amenities, i.e. parks and transportation, and biased variables based on the economic class and race of residents. HOLC grades were then used to determine a homeowner’s qualifications for a mortgage — homeowners in ‘D’ neighborhoods were less likely to receive friendly mortgages and reduced the value of their homes. The long-term impacts of HOLC grades included a drain of wealth from neighborhoods with unfavorable grades.
HOLC grades will be used as a backdrop for the other variables in our dataset. They will show how neighborhoods with poor grades rebounded over the past eight decades and what influence, if any, those grades have on a neighborhood's demographics and median income levels.
Demographic Data
Accompanying the HOLC grades in FiveThirtyEight’s dataset are modern demographic data that show the racial makeup of HOLC neighborhoods and surrounding areas. This includes base-data like total populations, as well as the percentage of a total population each demographic makes up. This will hasten analysis as some of our variables are pre-calculated.

zone-block-matches.csv
The other .csv file in this dataset is the product of FiveThirtyEight journalists matching old HOLC grades/neighborhoods with modern census blocks, then deriving census data and populating census geometry with it.


## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(sf)
library(janitor)
library(lubridate)

```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

There are 551 rows and 28 columns in the dataset.

```{r}
# Load required data

metro_grades<-read_csv("data/metro-grades.csv")

zone_block_matches<-st_read("data/zone-block-matches.csv")

```

## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

* **Sentence text**: For each Holc grade, what is the racial composition?
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

holc_grades_race <- metro_grades %>% 
  group_by(holc_grade) %>% 
  summarise(
    pct_white,
    pct_black,
    pct_hisp,
    pct_asian,
    pct_other)



# Display results of code below this codeblock

```

### Sentence 2

* **Sentence text**: What is the Holc grade breakdown by state? -- need to create a state column
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

metro_grades_plus_state <- metro_grades %>% 
  mutate(
    state=str_sub(metro_area, start=-2, end=-1)
  )

holc_by_state <- metro_grades_plus_state %>% 
  group_by(holc_grade, state) %>% 
  summarise(
    count=n()
  ) %>% 
  arrange(state)


# Display results of code below this codeblock

```

### Sentence 3

* **Sentence text**: For metro areas with at least 50% of a particular race, how many As, Bs, Cs, Ds are there?
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# lets do quartiles of percentages !!!, also consider plurality, not just majority
# Put code to reverse engineer sentence here
# could do something like this but idk why it's not working. may just have to do four tables (filtering on each quartile) for each race and jion them together to get what we want. i just feel like there's a more efficient way to do that - Devon

holc_count_white <- metro_grades %>% 
  mutate(
  white_neighborhoods_count = case_when(
    (pct_white %in% c(0:25)) == TRUE ~ "0-25% white neighborhood",
    (pct_white %in% c(25.01:50)) == TRUE ~ "25-50% white neighborhood",
    (pct_white %in% c(50.01:75)) == TRUE ~ "50-75% white neighborhood",
    (pct_white %in% c(75.01:100)) == TRUE ~ "75-100% white neighborhood")) %>% 
  group_by(white_neighborhoods_count) %>% 
  summarise(
    count = n()
  )
```
holc_count_black <- metro_grades %>% 
  group_by(holc_grade) %>% 
  filter(pct_black > 20) %>% 
  summarise(
    majority_black_neighborhoods_count = n()
  )

holc_count_hispanic  <- metro_grades %>% 
  group_by(holc_grade) %>% 
  filter(pct_hisp > 20) %>% 
  summarise(
    majority_hisp_neighborhoods_count = n()
  )

holc_count_asian  <- metro_grades %>% 
  group_by(holc_grade) %>% 
  filter(pct_asian > 20) %>% 
  summarise(
    majority_asian_neighborhoods_count = n()
  )

holc_count_other  <- metro_grades %>% 
  group_by(holc_grade) %>% 
  filter(pct_other > 20) %>% 
  summarise(
    majority_other_neighborhoods_count = n()
  )

holc_grades_by_race <- holc_count_white %>% inner_join(holc_count_black, by=c("holc_grade")) %>%  inner_join(holc_count_hispanic, by=c("holc_grade")) %>%  inner_join(holc_count_asian, by=c("holc_grade")) %>% inner_join(holc_count_other, by=c("holc_grade"))
# Display results of code below this codeblock

```

### Sentence 4

* **Sentence text**: [Paste in sentence to engineer here]
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Sentence 5

* **Sentence text**: [Paste in sentence to engineer here]
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}


```

-30-
